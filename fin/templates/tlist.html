{% extends 'masterp.html' %}
{% load humanize %}
{% block title %}

Transactions

{% endblock %}

{% block content %}

{% if page_obj %}

	<h1>Transactions</h1>

	<table class="table table-dark">
		
		<thead>
			<th scope="col">Date</th>
			<th scope="col">Account</th>
			<th scope="col">Payee</th>
			<th scope="col">Category</th>
			<th scope="col">Grouped</th>		
			<th scope="col">Match</th>
			<th scope="col">Account</th>
			<th scope="col">Sum</th>
		</thead>

		{% for t in page_obj %}

		<tr>
			<td>
                            {% if t.payee.active and t.account.active %}
                                   <a href="{% url 'utran_act' t.id %}?next={{ request.path|urlencode }}">{{ t.tdate }}</a>
                            {% else %}
                                   <a href="{% url 'utran' t.id %}?next={{ request.path|urlencode }}">{{ t.tdate }}</a>
                            {% endif %}
			
                     <td><a href="{% url 'tlist'  t.account.id 'all' 'all' 'all' %}"> {{ t.account }}</a></td>
			<td><a href="{% url 'tlist' 'all' 'all' 'all' t.payee.id %}"> {{ t.payee }}</a> <a href="{% url 'payee-detail' t.payee.id %}?next={{ request.path|urlencode }}">edit</a></td>
			<td><a href="{% url 'tlist' 'all' t.category.id 'all' 'all' %}"> {{ t.category }}</a></td>
                     <td>
                            {% if t.groupedcat %}
                            <a href="{% url 'tlist' 'all' 'all' t.groupedcat.id 'all' %}">{{ t.groupedcat }}</a>
                            {% endif %}
                     </td>
			<td>{{ t.match }}</td>
			<td>{{ t.amount|floatformat:"2g" }}</td>
			<td>{{ t.cumsum|floatformat:"2g" }}</td>
			<td><a href="{% url 'delete_trans' t.id %}">delete</a></td>
		</tr>

		{% endfor %}

	</table>

	{% else %}

	<p>No transactions yet.</p>

	{% endif %}

	<div class="pagination">
		<span class="step-links">
			{% if page_obj.has_previous %}
				<a href="?page=1">&laquo; first</a>
				<a href="?page={{ page_obj.previous_page_number }}">previous</a>
			{% endif %}

			<span class="current">
				Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
			</span>

			{% if page_obj.has_next %}
				<a href="?page={{ page_obj.next_page_number }}">next</a>
				<a href="?page={{ page_obj.paginator.num_pages }}">last &raquo;</a>
			{% endif %}
		</span>
	</div>

{% endblock %}